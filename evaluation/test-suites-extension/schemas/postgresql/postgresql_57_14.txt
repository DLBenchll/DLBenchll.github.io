DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id SERIAL PRIMARY KEY NOT NULL, mydate DATE NOT NULL);
INSERT INTO t1 VALUES (0, '2002-05-01'), (1, '2002-05-01'), (2, '2002-05-01');
SELECT * FROM t1 WHERE (mydate - DATE '1970-01-01')::int + 719528 IS NULL;
DROP TABLE t1;
CREATE TABLE t1 (pk INT PRIMARY KEY NOT NULL, col_int_key INT NOT NULL, col_date_key DATE NOT NULL);
INSERT INTO t1 VALUES (14,4,'1919-01-01'), (15,2,'2003-01-13'),(16,5,'2006-07-07'), (17,3,'1919-01-01');
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (pk INT PRIMARY KEY NOT NULL);
INSERT INTO t2 VALUES (1), (2), (3);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3(pk INT NOT NULL);
INSERT INTO t3 VALUES(1),(2),(3);
SELECT * FROM t3 LEFT JOIN t2 AS outr2 ON (outr2.pk <> t3.pk) LEFT JOIN t2 AS outr ON (outr.pk = t3.pk) LEFT JOIN t1 ON (t1.col_int_key = t3.pk) AND (t1.col_date_key IS NULL);
