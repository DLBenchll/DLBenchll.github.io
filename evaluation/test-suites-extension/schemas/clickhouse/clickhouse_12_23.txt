DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a Int32) ENGINE = MergeTree ORDER BY a;
INSERT INTO t1 VALUES (0),(1),(2),(3),(4),(5),(6),(7),(8),(9);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a Int32) ENGINE = MergeTree ORDER BY a;
INSERT INTO t2 SELECT A.a + 10 * (B.a + 10 * C.a) FROM t1 A, t1 B, t1 C;
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (a String NOT NULL, b String NOT NULL, filler String) ENGINE = MergeTree ORDER BY a;
INSERT INTO t3 SELECT concat('c-', toString(1000 + A.a), '=w'), concat('c-', toString(2000 + A.a), '=w'), 'filler-1' FROM t2 A;
INSERT INTO t3 SELECT concat('c-', toString(1000 + A.a), '=w'), concat('c-', toString(3000 + A.a), '=w'), 'filler-2' FROM t2 A;
INSERT INTO t3 VALUES ('c-1013=z', 'c-1013=z', 'err');
INSERT INTO t3 VALUES ('a-1014=w', 'a-1014=w', 'err');
DELETE FROM t3 WHERE b IN ('c-1013=z', 'a-1014=w');
INSERT INTO t3 VALUES ('c-1013=w', 'del-me', 'inserted');
DELETE FROM t3 WHERE b = 'del-me';
DROP TABLE t1;
DROP TABLE t2;
DROP TABLE t3;
DROP TABLE IF EXISTS t0;
CREATE TABLE t0 (a Int32) ENGINE = MergeTree ORDER BY a;
INSERT INTO t0 VALUES (0),(1),(2),(3),(4),(5),(6),(7),(8),(9);
CREATE TABLE t1 (a Int32, b String, filler String) ENGINE = Memory;
INSERT INTO t1 SELECT A.a + 10 * (B.a + 10 * C.a), 'bbb', 'filler' FROM t0 A, t0 B, t0 C;
